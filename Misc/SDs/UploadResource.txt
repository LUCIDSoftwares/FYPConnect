title Resource Uploading Sequence

participant "UploadResourcesController" as U
participant "ResourceHandler" as R
participant "DBHandler" as D

participant "UserSession" as F
participant "ConcretePersistenceFactory" as C

[->U: handleSubmit(title, description, selectedFile)
activate U
U->F: getCurrentUser()
activate F
F-->U: return currentUser (username)
deactivate F

U->R: handleSubmit(title, description, selectedFile)
activate R

R->C: createPersistenceHandler("DBHandler")
activate C
C-->R: return instance of DBHandler
deactivate C

alt file is selected
    R->R: generate newFileName and resources path
    R->R: copy file to resources directory
    R->D: saveResource(title, description, filePath, uploaderUsername)
    activate D
    D-->R: executeUpdate() success
    deactivate D
    R-->U: return true (file uploaded)
else no file selected
    R-->U: return false (file not uploaded)
end

U->[: display result (success or error message)
deactivate U



